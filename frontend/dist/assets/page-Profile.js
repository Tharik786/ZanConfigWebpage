import{r as o,j as e}from"./vendor-react.js";import{A as g}from"./api.js";function b(){const[n,l]=o.useState({username:"",email:""}),[h,d]=o.useState(!0),[c,u]=o.useState(!1),[f,s]=o.useState(""),[m,p]=o.useState(""),i=localStorage.getItem("token");o.useEffect(()=>{i?(async()=>{d(!0),s("");try{const t=await fetch(`${g}/user/profile`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}}),r=await t.json();!t.ok||!r.ok?s(r.error||"Failed to load profile"):(l({username:r.user.username,email:r.user.email}),localStorage.setItem("user",JSON.stringify(r.user)))}catch{s("Network error. Please try again.")}finally{d(!1)}})():(s("No token found, please login again."),d(!1))},[i]);const y=async a=>{a.preventDefault(),u(!0),s(""),p("");try{const t=await fetch(`${g}/user/profile`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(n)}),r=await t.json();!t.ok||!r.ok?s(r.error||"Failed to update profile"):(p("Profile updated successfully"),localStorage.setItem("user",JSON.stringify(r.user)))}catch{s("Network error. Please try again.")}finally{u(!1)}};return h?e.jsx("p",{children:"Loading profile…"}):e.jsx("div",{style:{display:"flex",justifyContent:"center",paddingTop:40},children:e.jsxs("div",{style:{width:"100%",maxWidth:400},children:[e.jsx("h2",{style:{marginBottom:16,textAlign:"center"},children:"Profile"}),f&&e.jsx("div",{style:{background:"#fee2e2",padding:10,borderRadius:6,marginBottom:12,color:"#b91c1c",fontSize:14},children:f}),m&&e.jsx("div",{style:{background:"#dcfce7",padding:10,borderRadius:6,marginBottom:12,color:"#166534",fontSize:14},children:m}),e.jsxs("form",{onSubmit:y,style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:14},children:"Username"}),e.jsx("input",{type:"text",name:"username",value:n.username,onChange:a=>l(t=>({...t,username:a.target.value})),style:{width:"100%",padding:10,borderRadius:6,border:"1px solid #d1d5db",fontSize:14}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:14},children:"Email"}),e.jsx("input",{type:"email",name:"email",value:n.email,onChange:a=>l(t=>({...t,email:a.target.value})),style:{width:"100%",padding:10,borderRadius:6,border:"1px solid #d1d5db",fontSize:14}})]}),e.jsx("button",{type:"submit",disabled:c,style:{padding:"8px 12px",background:"#3246a8",color:"#fff",border:"none",borderRadius:4,fontSize:14,cursor:"pointer"},children:c?"Saving…":"Save Changes"})]})]})})}export{b as P};
